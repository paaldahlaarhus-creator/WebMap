[
  {
    "objectID": "pages/Oslofjord.html",
    "href": "pages/Oslofjord.html",
    "title": "Oslofjorden",
    "section": "",
    "text": "library(here)\n\nhere() starts at /Users/paal1205/Documents/DataScience/WebMap\n\nlibrary(qs)\n\nqs 0.27.3. Announcement: https://github.com/qsbase/qs/issues/103\n\nlibrary(sf)\n\nLinking to GEOS 3.13.0, GDAL 3.8.5, PROJ 9.5.1; sf_use_s2() is TRUE\n\nlibrary(leaflet)\nlibrary(htmltools)\nlibrary(dplyr)\n\n\nAttaching package: 'dplyr'\n\n\nThe following objects are masked from 'package:stats':\n\n    filter, lag\n\n\nThe following objects are masked from 'package:base':\n\n    intersect, setdiff, setequal, union\n\n# helper: load qs if available, fallback to geojson\nread_map &lt;- function(qs_path, geojson_path) {\n  if (file.exists(qs_path)) {\n    tryCatch(\n      qs::qread(qs_path),\n      error = function(e) {\n        message(\"Could not read .qs, using GeoJSON instead.\")\n        st_read(geojson_path, quiet = TRUE)\n      }\n    )\n  } else {\n    st_read(geojson_path, quiet = TRUE)\n  }\n}\n\n# load kommuner\nkomm_qs  &lt;- here(\"data\", \"kommuner.qs\")\nkomm_geo &lt;- here(\"www\", \"assets\", \"kommuner.geojson\")\nkommuner &lt;- read_map(komm_qs, komm_geo)\n\n# ensure CRS\nif (is.na(st_crs(kommuner))) st_crs(kommuner) &lt;- 4258\nkommuner &lt;- st_transform(kommuner, 4326)\n\n# choose name column\nlab_komm &lt;- names(kommuner)[grepl(\"kommunenavn\", names(kommuner), ignore.case = TRUE)][1]\n\n# Oslofjord municipalities using correct names\noslofjord_names &lt;- c(\n  \"Oslo\",\"Bærum\",\"Asker\",\"Nesodden\",\"Frogn\",\"Ås\",\"Vestby\",\"Moss\",\n  \"Fredrikstad\",\"Hvaler\",\"Tønsberg\",\"Horten\",\"Larvik\",\"Sandefjord\",\n  \"Færder\"\n)\n\n# filter\nof_komm &lt;- kommuner |&gt; filter(get(lab_komm) %in% oslofjord_names)\n\n# build map\nleaflet(of_komm) %&gt;%\n  addProviderTiles(providers$CartoDB.Positron) %&gt;%\n  addPolygons(\n    color = \"#2166ac\",\n    fillOpacity = 0.4,\n    weight = 1,\n    label = ~ get(lab_komm)\n  ) %&gt;%\n  setView(lng = 10.5, lat = 59.2, zoom = 9)"
  },
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Load required packages",
    "section": "",
    "text": "Load required packages\nlibrary(here) library(qs) library(sf) library(leaflet) library(htmltools)\n\n\nLocal screenshot (you provided this file)\nsite_image &lt;- “/mnt/data/Screenshot 2025-11-12 at 18.55.31.png”\n\n\nHelper: safe read .qs (fast) or fallback to GeoJSON (slower)\nread_map &lt;- function(qs_path, geojson_path) { if (file.exists(qs_path)) { tryCatch(qs::qread(qs_path), error = function(e) { message(“Failed to read”, qs_path, ” (“, e$message,”). Falling back to GeoJSON.”) st_read(geojson_path, quiet = TRUE) }) } else if (file.exists(geojson_path)) { message(“Preprocessed .qs not found; reading raw GeoJSON (this may be slow).”) st_read(geojson_path, quiet = TRUE) } else { stop(“Neither”, qs_path, ” nor “, geojson_path,” exist.”) } }\n\n\nPaths (relative to project root)\nkommuner_qs &lt;- here(“data”, “kommuner.qs”) fylker_qs &lt;- here(“data”, “fylker.qs”)\nkommuner_geo &lt;- here(“www”, “assets”, “kommuner.geojson”) fylker_geo &lt;- here(“www”, “assets”, “fylker.geojson”)\n\n\nRead data (fast if qs exist)\nkommuner &lt;- read_map(kommuner_qs, kommuner_geo) fylker &lt;- read_map(fylker_qs, fylker_geo)\n\n\nEnsure geometry CRS is WGS84 for leaflet\nif (is.na(st_crs(kommuner))) st_crs(kommuner) &lt;- 4258 if (is.na(st_crs(fylker))) st_crs(fylker) &lt;- 4258 kommuner &lt;- st_transform(kommuner, 4326) fylker &lt;- st_transform(fylker, 4326)\n\n\nFind a sensible label column (try common names)\nfind_label &lt;- function(x) { nm &lt;- names(x) cand &lt;- nm[grepl(“navn|name|kommunenavn|administrativenhetnavn”, nm, ignore.case = TRUE)] if (length(cand)) return(cand[1]) return(nm[1]) } label_kommune &lt;- find_label(kommuner) label_fylke &lt;- find_label(fylker)\n\n\nSimple popup text (escape HTML)\npopup_text &lt;- function(df, labcol) { vals &lt;- as.character(df[[labcol]]) htmlEscape(vals) }\nkomm_popup &lt;- popup_text(kommuner, label_kommune) fylk_popup &lt;- popup_text(fylker, label_fylke)\n\n\nColours / palette\nfylke_color &lt;- “#D73027” # red-ish komm_color &lt;- “#4575B4” # blue-ish\n\n\nInitial map view (Norway center) - adjust if you prefer different default\ninit_lat &lt;- 64 init_lng &lt;- 12 init_zoom &lt;- 5\n\n\nBuild leaflet map\nm &lt;- leaflet(options = leafletOptions(zoomControl = TRUE)) %&gt;% addProviderTiles(providers$CartoDB.Positron, group = “Base”) %&gt;% addPolygons( data = fylker, color = fylke_color, weight = 1, fillOpacity = 0.25, label = ~ htmltools::HTML(paste0(“”, htmlEscape(get(label_fylke)), “”)), popup = ~ fylk_popup, group = “Fylker”, highlight = highlightOptions(weight = 3, bringToFront = TRUE) ) %&gt;% addPolygons( data = kommuner, color = komm_color, weight = 0.8, fillOpacity = 0.35, label = ~ htmltools::HTML(paste0(htmlEscape(get(label_kommune)))), popup = ~ komm_popup, group = “Kommuner”, highlight = highlightOptions(weight = 3, bringToFront = TRUE) ) %&gt;% addLayersControl( baseGroups = c(“Base”), overlayGroups = c(“Fylker”, “Kommuner”), options = layersControlOptions(collapsed = FALSE) ) %&gt;% setView(lng = init_lng, lat = init_lat, zoom = init_zoom)\n\n\nPrint map\nm"
  },
  {
    "objectID": "pages/kommunekart.html",
    "href": "pages/kommunekart.html",
    "title": "Fylker og kommuner",
    "section": "",
    "text": "library(here)\n\nhere() starts at /Users/paal1205/Documents/DataScience/WebMap\n\nlibrary(qs)\n\nqs 0.27.3. Announcement: https://github.com/qsbase/qs/issues/103\n\nlibrary(sf)\n\nLinking to GEOS 3.13.0, GDAL 3.8.5, PROJ 9.5.1; sf_use_s2() is TRUE\n\nlibrary(leaflet)\nlibrary(htmltools)\n\n# Optional local image (change to a file in www/assets if you add it there)\nsite_image &lt;- \"/mnt/data/Screenshot 2025-11-12 at 18.55.31.png\"\n\n# helper to read fast .qs or fallback to GeoJSON\nread_map &lt;- function(qs_path, geojson_path) {\n  if (file.exists(qs_path)) {\n    tryCatch(qs::qread(qs_path),\n             error = function(e) {\n               message(\"Failed to read \", qs_path, \" (\", e$message, \"). Falling back to GeoJSON.\")\n               st_read(geojson_path, quiet = TRUE)\n             })\n  } else if (file.exists(geojson_path)) {\n    message(\"Preprocessed .qs not found; reading raw GeoJSON (this may be slow).\")\n    st_read(geojson_path, quiet = TRUE)\n  } else {\n    stop(\"Neither \", qs_path, \" nor \", geojson_path, \" exist.\")\n  }\n}\n\n# paths\nkommuner_qs &lt;- here(\"data\",\"kommuner.qs\")\nfylker_qs   &lt;- here(\"data\",\"fylker.qs\")\nkommuner_geo &lt;- here(\"www\",\"assets\",\"kommuner.geojson\")\nfylker_geo   &lt;- here(\"www\",\"assets\",\"fylker.geojson\")\n\n# load\nkommuner &lt;- read_map(kommuner_qs, kommuner_geo)\nfylker   &lt;- read_map(fylker_qs,   fylker_geo)\n\n# ensure CRS 4326 (WGS84)\nif (is.na(st_crs(kommuner))) st_crs(kommuner) &lt;- 4258\nif (is.na(st_crs(fylker)))   st_crs(fylker)   &lt;- 4258\nkommuner &lt;- st_transform(kommuner, 4326)\nfylker   &lt;- st_transform(fylker,   4326)\n\n# helper to pick label column\npick_label &lt;- function(x) {\n  nm &lt;- names(x)\n  cand &lt;- nm[grepl(\"navn|name|kommunenavn|administrativenhetnavn\", nm, ignore.case = TRUE)]\n  if (length(cand)) return(cand[1])\n  nm[1]\n}\nlab_komm &lt;- pick_label(kommuner)\nlab_fylk &lt;- pick_label(fylker)\n\n# popup helper\npopup_html &lt;- function(df, labcol) {\n  vals &lt;- as.character(df[[labcol]])\n  vapply(vals, htmlEscape, FUN.VALUE = character(1))\n}\n\nkomm_popup &lt;- popup_html(kommuner, lab_komm)\nfylk_popup &lt;- popup_html(fylker, lab_fylk)\n\n# colors\ncol_fylke &lt;- \"#d73027\"\ncol_komm  &lt;- \"#4575b4\"\n\n# build map with layers control\nleaflet(options = leafletOptions(zoomControl = TRUE)) %&gt;%\n  addProviderTiles(providers$CartoDB.Positron, group = \"Bakgrunn\") %&gt;%\n  addPolygons(\n    data = fylker,\n    group = \"Fylker\",\n    color = col_fylke,\n    weight = 1,\n    fillOpacity = 0.25,\n    label = ~ htmltools::HTML(paste0(\"&lt;b&gt;\", htmlEscape(get(lab_fylk)), \"&lt;/b&gt;\")),\n    popup = ~ fylk_popup,\n    highlight = highlightOptions(weight = 3, bringToFront = TRUE)\n  ) %&gt;%\n  addPolygons(\n    data = kommuner,\n    group = \"Kommuner\",\n    color = col_komm,\n    weight = 0.8,\n    fillOpacity = 0.35,\n    label = ~ htmltools::HTML(htmlEscape(get(lab_komm))),\n    popup = ~ komm_popup,\n    highlight = highlightOptions(weight = 3, bringToFront = TRUE)\n  ) %&gt;%\n  addLayersControl(\n    baseGroups = c(\"Bakgrunn\"),\n    overlayGroups = c(\"Fylker\", \"Kommuner\"),\n    options = layersControlOptions(collapsed = FALSE)\n  )\n\nInput to asJSON(keep_vec_names=TRUE) is a named vector. In a future version of jsonlite, this option will not be supported, and named vectors will be translated into arrays instead of objects. If you want JSON object output, please use a named list instead. See ?toJSON.\n\n\nInput to asJSON(keep_vec_names=TRUE) is a named vector. In a future version of jsonlite, this option will not be supported, and named vectors will be translated into arrays instead of objects. If you want JSON object output, please use a named list instead. See ?toJSON."
  }
]